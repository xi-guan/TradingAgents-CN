# TradingAgents-CN 功能规格说明书
# Feature Specification for TradingAgents-CN Enhancements

> **目的**: 本文档提供 TradingAgents-CN 相比原始 TradingAgents 的所有功能改进点的详细规格说明
> **用途**: 作为独立实现的参考文档（提取功能需求而非代码实现）
> **版本**: 基于 TradingAgents-CN v1.0.0-preview
> **日期**: 2025-11-17

---

## 📋 目录

1. [项目定位](#1-项目定位)
2. [技术架构改进](#2-技术架构改进)
3. [Web应用层功能](#3-web应用层功能)
4. [中文化与本地化](#4-中文化与本地化)
5. [多市场数据支持](#5-多市场数据支持)
6. [LLM生态系统增强](#6-llm生态系统增强)
7. [分析功能增强](#7-分析功能增强)
8. [报告导出系统](#8-报告导出系统)
9. [数据处理优化](#9-数据处理优化)
10. [开发者工具](#10-开发者工具)

---

## 1. 项目定位

### 1.1 核心定位
- **学习与研究平台**: 专注于股票分析学习，不提供实盘交易指令
- **中文用户友好**: 面向中国用户的完整中文化体验
- **多市场支持**: 支持A股、港股、美股三大市场

### 1.2 目标用户
- 个人投资者学习者
- 量化交易研究者
- 金融专业学生
- AI应用开发者

---

## 2. 技术架构改进

### 2.1 整体架构

```
原始 TradingAgents: CLI + Streamlit
        ↓
TradingAgents-CN: CLI + Streamlit + FastAPI后端 + Vue前端
```

### 2.2 核心技术栈

#### 后端架构
- **框架**: FastAPI (异步Python Web框架)
- **数据库**: MongoDB (主数据存储) + Redis (缓存)
- **认证**: JWT Token 认证
- **API设计**: RESTful API
- **架构模式**: 分层架构（路由 → 服务 → 模型）

#### 前端架构
- **框架**: Vue 3 + TypeScript
- **构建工具**: Vite
- **UI组件库**: Element Plus
- **状态管理**: Pinia
- **路由**: Vue Router

#### 部署支持
- **容器化**: Docker + Docker Compose
- **多架构**: x86_64 和 ARM64 支持
- **反向代理**: Nginx (可选)

### 2.3 架构特点

#### 前后端分离
- 后端: FastAPI 提供 API 服务
- 前端: Vue SPA 应用
- 通信: RESTful API + WebSocket (实时通知)

#### 数据流设计
```
用户请求 → Vue前端 → FastAPI后端 → TradingAgents核心
                                    ↓
                            MongoDB/Redis
```

---

## 3. Web应用层功能

> 这是TradingAgents-CN的主要增强部分，原始项目只有CLI和基础Streamlit界面

### 3.1 用户认证与权限

#### 用户管理
- **注册/登录**: 用户名密码认证
- **会话管理**: JWT Token + Redis会话
- **权限控制**: 基于角色的访问控制 (RBAC)
- **默认账户**: admin/admin123 (可配置)

#### 安全特性
- 密码加密存储
- Token过期机制
- API访问控制
- 请求频率限制

### 3.2 配置中心

#### 厂家(LLM提供商)管理
**功能需求**:
- CRUD操作: 创建、读取、更新、删除厂家配置
- 字段:
  - `id`: 唯一标识符
  - `name`: 厂家名称 (如 "dashscope")
  - `display_name`: 显示名称 (如 "阿里百炼")
  - `description`: 描述信息
  - `is_active`: 启用状态
  - `config_template`: 配置模板 (JSON)
  - `api_endpoint`: API端点URL
  - `created_at`, `updated_at`: 时间戳

**UI需求**:
- 厂家列表展示 (卡片式或表格式)
- 添加/编辑对话框
- 启用/禁用切换
- 搜索和过滤

#### 大模型配置管理
**功能需求**:
- 模型配置 CRUD
- 字段:
  - `id`: 唯一标识符
  - `provider`: 所属厂家
  - `model_name`: 模型代码 (如 "qwen-turbo")
  - `model_display_name`: 显示名称 (如 "Qwen3系列Flash模型")
  - `api_key`: API密钥 (加密存储)
  - `enabled`: 启用状态
  - `pricing`: 定价信息
    - `input_price`: 输入价格 (每1M tokens)
    - `output_price`: 输出价格 (每1M tokens)
    - `currency`: 货币单位 (CNY/USD)
  - `parameters`: 模型参数 (temperature, max_tokens等)

**智能功能**:
- 模型选择下拉框 (预定义模型列表)
- 自动填充: 选择模型后自动填充名称和价格
- 状态检查: API密钥有效性验证
- 使用统计: 记录各模型调用次数和成本

#### 系统设置
**功能需求**:
- 全局配置管理
- 字段:
  - `default_provider`: 默认数据供应商
  - `quick_analysis_model`: 快速分析模型
  - `deep_decision_model`: 深度决策模型
  - `cache_enabled`: 缓存启用
  - `cache_ttl`: 缓存过期时间
  - `max_concurrent_tasks`: 最大并发任务数
  - `notification_enabled`: 通知启用

**联动逻辑**:
- 数据供应商选择 → 自动更新可选模型列表
- 模型选择 → 只显示已启用的模型
- 配置验证 → 保存前检查配置有效性

### 3.3 批量分析功能

#### 核心需求
**问题**: 原始版本只能单股票分析，效率低
**解决方案**: 支持多股票并发分析

#### 功能特性
1. **批量任务创建**
   - 输入: 股票代码列表 (逗号分隔或换行分隔)
   - 配置: 分析深度、智能体选择、分析时间
   - 验证: 自动验证股票代码格式

2. **并发分析引擎**
   - 异步任务队列
   - 可配置并发数 (如: 3-5个并发)
   - 智能调度: 避免API限流

3. **实时进度追踪**
   - WebSocket推送进度更新
   - 进度条显示 (0-100%)
   - 当前状态显示 (队列中/分析中/已完成/失败)
   - 预计剩余时间

4. **结果管理**
   - 批量结果列表展示
   - 横向对比功能
   - 按指标排序 (如按推荐评分排序)
   - 导出全部结果

#### UI设计要点
```
批量分析页面
├── 股票代码输入区 (支持批量输入)
├── 分析配置面板
│   ├── 分析深度选择
│   ├── 智能体勾选
│   └── 高级选项
├── 任务队列展示
│   ├── 任务列表 (状态、进度)
│   └── 整体进度条
└── 结果展示区
    ├── 结果列表 (表格/卡片)
    ├── 对比视图
    └── 批量导出按钮
```

### 3.4 股票筛选功能

#### 核心需求
**目标**: 从市场中筛选符合条件的股票

#### 筛选维度

1. **财务指标筛选**
   - PE (市盈率): 范围筛选
   - PB (市净率): 范围筛选
   - ROE (净资产收益率): 最小值筛选
   - 净利润率: 范围筛选
   - 毛利率: 范围筛选
   - 营收增长率: 范围筛选
   - 净利润增长率: 范围筛选

2. **技术指标筛选**
   - MA (均线): 金叉/死叉，多头/空头排列
   - MACD: 金叉/死叉，柱状图方向
   - RSI: 超买/超卖区间
   - BOLL: 突破上轨/下轨
   - 成交量: 放量/缩量

3. **市场特征筛选**
   - 市值: 范围筛选 (大盘/中盘/小盘)
   - 行业: 申万行业分类
   - 概念板块: 热门概念筛选
   - 涨跌幅: 日/周/月涨跌幅范围
   - 换手率: 范围筛选

4. **组合筛选**
   - 支持多条件AND/OR组合
   - 预设策略 (如: 价值股、成长股、高股息)
   - 自定义策略保存

#### 功能特性
- **实时筛选**: 基于最新数据
- **策略保存**: 保存筛选条件供复用
- **结果排序**: 按任意指标排序
- **批量分析**: 筛选结果一键批量分析
- **历史回测**: 查看历史时间点的筛选结果

### 3.5 个股详情页

#### 核心需求
**目标**: 提供单个股票的全方位信息

#### 信息模块

1. **基本信息**
   - 公司名称、代码、行业
   - 主营业务描述
   - 上市时间、总市值
   - 股东结构

2. **实时行情**
   - 当前价格
   - 涨跌额、涨跌幅
   - 今开、最高、最低
   - 成交量、成交额
   - 换手率

3. **财务数据**
   - 盈利能力指标 (ROE, 净利润率, 毛利率)
   - 偿债能力指标 (资产负债率, 流动比率)
   - 运营能力指标 (存货周转率, 应收账款周转率)
   - 估值指标 (PE, PB, PS, PEG)
   - 历史财报数据 (季度/年度)

4. **技术分析**
   - K线图 (日线/周线/月线)
   - 技术指标图表 (MA, MACD, RSI, KDJ, BOLL)
   - 成交量图
   - 技术形态识别

5. **新闻舆情**
   - 公司公告列表
   - 新闻资讯
   - 研报分析
   - 社交媒体情绪

#### UI交互
- Tab页签切换不同模块
- 图表交互 (缩放、拖动、指标切换)
- 数据导出功能
- 添加到自选股

### 3.6 自选股管理

#### 核心需求
**目标**: 让用户管理个人关注的股票

#### 功能特性

1. **分组管理**
   - 创建多个分组 (如: "价值股", "成长股", "高股息")
   - 重命名/删除分组
   - 拖拽股票到不同分组

2. **股票操作**
   - 添加/移除股票
   - 批量添加 (从筛选结果)
   - 股票备注

3. **标签系统**
   - 自定义标签 (如: "关注", "持有", "观察")
   - 多标签支持
   - 按标签筛选

4. **实时监控**
   - 自选股列表实时更新价格
   - 涨跌幅颜色标识
   - 重要指标显示 (PE, ROE等)

5. **智能提醒**
   - 价格突破提醒 (突破设定价格)
   - 技术指标信号 (金叉、超买超卖)
   - 重要公告提醒

### 3.7 模拟交易

#### 核心需求
**目标**: 提供虚拟交易环境进行策略测试

#### 功能特性

1. **虚拟账户**
   - 初始资金设置 (如: 100万)
   - 资金流水记录
   - 账户余额实时更新

2. **交易功能**
   - 买入操作 (市价/限价)
   - 卖出操作 (市价/限价)
   - 交易手续费计算
   - 交易记录

3. **持仓管理**
   - 持仓列表 (股票、数量、成本价)
   - 当前市值计算
   - 盈亏统计 (持仓盈亏、总盈亏)
   - 持仓占比

4. **交易分析**
   - 收益率曲线
   - 最大回撤
   - 胜率统计
   - 交易记录导出

---

## 4. 中文化与本地化

### 4.1 界面中文化

#### UI文本
- 所有界面元素完全中文化
- 字段标签、按钮文本、提示信息
- 错误消息和警告提示
- 帮助文档和引导文本

#### 日期时间本地化
- 中国时区 (UTC+8)
- 中文日期格式
- 交易日历 (考虑中国节假日)

### 4.2 中文文档系统

#### 文档结构
- 快速开始指南
- 详细安装说明 (Windows/Mac/Linux)
- 功能使用教程
- 常见问题解答
- 故障排除指南

#### 技术文档
- API接口文档 (中文)
- 架构设计文档
- 开发者指南
- 部署运维手册

### 4.3 中文数据处理

#### 公司名称
- 支持中文公司全称
- 中文简称匹配
- 拼音搜索支持

#### 行业分类
- 申万行业分类 (中文)
- 概念板块 (中文)
- 地域分类 (省份/城市)

#### 新闻分析
- 中文新闻抓取
- 中文文本分析
- 中文情感分析

---

## 5. 多市场数据支持

### 5.1 A股市场支持

#### 数据需求
1. **基础数据**
   - 股票基本信息 (代码、名称、行业)
   - 实时行情数据
   - 历史K线数据 (日/周/月)
   - 成交量数据

2. **财务数据**
   - 利润表、资产负债表、现金流量表
   - 财务指标 (ROE, 净利率, 毛利率等)
   - 季度报告、年度报告
   - 业绩快报、业绩预告

3. **技术指标**
   - MA (5, 10, 20, 60, 120, 250日均线)
   - MACD (12, 26, 9)
   - RSI (6, 12, 24) - 中国风格
   - KDJ (9, 3, 3)
   - BOLL (20, 2)

4. **估值数据**
   - PE (动态市盈率)
   - PB (市净率)
   - PS (市销率)
   - PEG
   - 市值数据

#### 代码格式
- 6位数字代码 (如: 000001)
- 完整代码: {code}.{market} (如: 000001.SZ, 600000.SH)
- 市场标识: SH (上交所), SZ (深交所), BJ (北交所)

#### 数据源需求
- 日线/分钟线数据
- 复权处理 (前复权/后复权)
- 数据质量验证
- 数据缓存机制

### 5.2 港股市场支持

#### 数据需求
1. **基础数据**
   - 股票代码 (5位数字, 如: 00700)
   - 中英文名称
   - 行业分类
   - 主板/创业板标识

2. **行情数据**
   - 实时报价 (港币)
   - 历史K线
   - 成交量 (股)
   - 成交额 (港币)

3. **财务数据**
   - 年报/中报数据
   - 港股财务指标
   - PE, PB, 股息率

4. **技术指标**
   - 与A股相同的技术指标计算
   - 考虑港股交易时间

#### 特殊处理
- 货币单位: 港币 (HKD)
- 交易时间: 09:30-16:00 (含午休)
- 涨跌幅限制: 无涨跌停板

### 5.3 美股市场支持

#### 数据需求
1. **基础数据**
   - 股票代码 (字母, 如: AAPL)
   - 公司名称
   - 交易所 (NYSE/NASDAQ)
   - 行业分类 (GICS)

2. **行情数据**
   - 实时报价 (美元)
   - 盘前/盘后数据
   - 历史K线
   - 成交量

3. **财务数据**
   - 季度财报 (Q1-Q4)
   - 年度财报 (10-K)
   - SEC文件
   - 财务指标

#### 特殊处理
- 货币单位: 美元 (USD)
- 时区转换: ET → UTC+8
- 交易时间: 09:30-16:00 ET

### 5.4 数据字段标准化

#### 统一字段命名
```
标准字段名        | 说明           | 示例
-----------------|----------------|--------
symbol           | 股票代码        | "000001"
full_symbol      | 完整代码        | "000001.SZ"
market_code      | 市场代码        | "SZ"
name             | 股票名称        | "平安银行"
industry         | 行业           | "银行"
price            | 当前价格        | 12.50
change_pct       | 涨跌幅(%)      | 2.5
volume           | 成交量         | 1000000
market_cap       | 总市值         | 1000000000
pe_ratio         | 市盈率         | 8.5
pb_ratio         | 市净率         | 0.8
```

#### 数据类型规范
- 价格: float (保留2位小数)
- 百分比: float (如 2.5 表示 2.5%)
- 市值: long (单位: 元/港币/美元)
- 成交量: long (单位: 股)

---

## 6. LLM生态系统增强

### 6.1 多LLM提供商支持

#### 支持的提供商

1. **国内提供商**
   - **阿里百炼 (DashScope)**
     - 模型: qwen-turbo, qwen-plus, qwen-max, qwen-long
     - 特点: 中文优化，工具调用强

   - **DeepSeek**
     - 模型: deepseek-chat, deepseek-reasoner
     - 特点: 性价比极高，推理能力强

   - **百度千帆 (Qianfan)**
     - 模型: ERNIE-3.5, ERNIE-4.0
     - 特点: 中文理解，企业级

   - **智谱AI (GLM)**
     - 模型: glm-4, glm-4-plus
     - 特点: 长文本支持

2. **国际提供商**
   - **OpenAI**
     - 模型: gpt-4o, gpt-4-turbo, gpt-3.5-turbo

   - **Anthropic**
     - 模型: claude-3.5-sonnet, claude-3-opus

   - **Google AI**
     - 模型: gemini-2.5-pro, gemini-2.0-flash

   - **OpenRouter**
     - 聚合多个提供商，统一接口

### 6.2 统一适配器架构

#### 设计原则
- **OpenAI兼容**: 以OpenAI API为基准
- **适配器模式**: 各提供商实现统一接口
- **可扩展**: 易于添加新提供商

#### 核心接口
```python
class BaseLLMAdapter:
    """LLM适配器基类"""

    def chat_completion(self, messages, tools, **kwargs):
        """聊天补全"""
        pass

    def validate_api_key(self):
        """验证API密钥"""
        pass

    def get_model_info(self):
        """获取模型信息"""
        pass
```

#### 功能需求
1. **统一调用接口**
   - 消息格式转换
   - 工具调用转换
   - 响应格式统一

2. **错误处理**
   - API错误捕获
   - 重试机制 (指数退避)
   - 降级策略

3. **性能优化**
   - 请求并发控制
   - 响应缓存
   - 调用统计

### 6.3 模型选择持久化

#### 需求
- 用户选择的模型配置持久化存储
- 下次使用时自动加载上次的选择
- 支持不同场景的模型预设

#### 实现要点
- 存储位置: 数据库或配置文件
- 字段: 用户ID, 场景, 提供商, 模型名称
- 快速切换: 快捷按钮切换常用模型

### 6.4 API密钥管理

#### 安全需求
1. **密钥存储**
   - 加密存储在数据库
   - 不明文显示在界面
   - 支持环境变量配置

2. **密钥验证**
   - 保存前验证有效性
   - 定期检查密钥状态
   - 失效提醒

3. **权限控制**
   - 用户只能管理自己的密钥
   - 管理员可查看所有密钥
   - 操作日志记录

---

## 7. 分析功能增强

### 7.1 智能新闻分析

#### 核心需求
**原始版本问题**: 新闻分析简单，质量参差不齐
**改进目标**: 多层次过滤，质量评估

#### 功能特性

1. **新闻获取**
   - 多数据源聚合
   - 时间范围筛选
   - 去重处理

2. **多层次过滤**
   - **相关性过滤**
     - 标题关键词匹配
     - 内容相关度评分
     - 过滤无关新闻

   - **时效性过滤**
     - 优先最新新闻
     - 过期新闻降权

   - **质量评估**
     - 来源可信度评分
     - 内容质量评分
     - 信息丰富度评分

3. **情感分析**
   - 标题情感分析
   - 内容情感分析
   - 整体情绪评分 (看涨/看跌/中性)

4. **摘要生成**
   - 新闻摘要提取
   - 关键信息提炼
   - 影响评估

### 7.2 死循环问题修复

#### 问题描述
- 某些模型 (如DeepSeek) 在新闻分析时出现死循环
- 工具调用无限循环
- 分析无法完成

#### 解决方案
1. **循环检测**
   - 记录工具调用历史
   - 检测重复调用模式
   - 超过阈值则中断

2. **超时机制**
   - 单个智能体超时设置
   - 整体分析超时设置
   - 超时后自动终止

3. **降级策略**
   - 简化分析流程
   - 跳过问题步骤
   - 返回部分结果

### 7.3 技术指标统一计算

#### 问题
- 不同地方的技术指标计算不一致
- 代码重复，维护困难

#### 解决方案
1. **共享指标库**
   - 统一的指标计算函数
   - 标准化参数
   - 单元测试覆盖

2. **支持的指标**
   - MA (移动平均线)
   - MACD (指数平滑异同移动平均线)
   - RSI (相对强弱指标)
   - KDJ (随机指标)
   - BOLL (布林带)

3. **计算标准**
   - RSI: 支持国际标准 (RSI14+EMA) 和中国风格 (RSI6/12/24+SMA)
   - MACD: (12, 26, 9)
   - KDJ: (9, 3, 3)

### 7.4 财务数据修复

#### 毛利率字段修复
**问题**: 使用了错误的 `gross_margin` 字段 (毛利绝对值)
**解决**: 改用 `grossprofit_margin` 字段 (销售毛利率百分比)

#### 亏损股PE计算修复
**问题**: 亏损股显示错误的正PE值
**解决**: 3层PE计算降级策略
1. 优先使用实时PE
2. 降级使用TTM PE
3. 净利润<0 则显示 N/A

---

## 8. 报告导出系统

### 8.1 PDF报告导出

#### 功能需求
- 将分析结果导出为专业PDF报告
- 包含图表、表格、文字分析
- 支持中文字体

#### 报告结构
```
封面
├── 股票名称和代码
├── 分析时间
└── 生成时间

执行摘要
├── 投资建议 (买入/持有/卖出)
├── 目标价位
├── 风险评级
└── 关键指标

详细分析
├── 基本面分析
│   ├── 财务数据
│   ├── 估值分析
│   └── 行业地位
├── 技术分析
│   ├── K线图
│   ├── 技术指标
│   └── 趋势分析
├── 新闻分析
│   ├── 重要新闻
│   ├── 情感分析
│   └── 事件影响
└── 风险提示

附录
├── 数据来源
├── 分析方法
└── 免责声明
```

#### 技术要点
- 模板引擎: Jinja2 或类似
- PDF生成: ReportLab, WeasyPrint 或类似
- 图表生成: Matplotlib, Plotly
- 中文字体: 思源黑体或类似

### 8.2 Word报告导出

#### 功能需求
- 导出可编辑的Word文档
- 保持格式和样式
- 支持表格和图表

#### 技术要点
- Word生成: python-docx 或类似
- 与PDF使用相同的数据和模板
- 图表以图片形式嵌入

### 8.3 报告模板

#### 模板系统
- 可自定义模板
- 支持不同风格 (专业/简洁/详细)
- 品牌定制 (logo, 颜色)

#### 批量导出
- 批量分析结果批量导出
- 汇总报告生成
- 对比报告生成

---

## 9. 数据处理优化

### 9.1 数据同步优化

#### 问题
- 原始版本数据同步慢
- 缺乏进度提示
- 错误处理不足

#### 改进
1. **异步数据同步**
   - 后台任务队列
   - 并发请求控制
   - 断点续传

2. **进度追踪**
   - 实时进度更新
   - 剩余时间估算
   - 成功/失败统计

3. **增量更新**
   - 只更新变化的数据
   - 减少API调用
   - 提升同步速度

### 9.2 数据缓存机制

#### 缓存策略
1. **多级缓存**
   - L1: 内存缓存 (Redis)
   - L2: 数据库缓存
   - L3: 文件缓存

2. **缓存失效**
   - 基于时间的失效 (TTL)
   - 基于事件的失效
   - 主动刷新机制

3. **缓存预热**
   - 常用数据预加载
   - 热门股票数据缓存
   - 定时更新

### 9.3 数据质量保证

#### 数据验证
1. **格式验证**
   - 代码格式检查
   - 数值范围检查
   - 必填字段检查

2. **一致性检查**
   - 跨表数据一致性
   - 历史数据连续性
   - 计算结果验证

3. **异常处理**
   - 缺失数据处理
   - 异常值检测
   - 数据修复建议

---

## 10. 开发者工具

### 10.1 Docker支持

#### 镜像构建
- 多阶段构建优化
- 多架构支持 (x86_64, ARM64)
- 镜像大小优化

#### Docker Compose
```yaml
services:
  - app (FastAPI后端)
  - frontend (Vue前端)
  - streamlit (Streamlit应用)
  - mongodb (数据库)
  - redis (缓存)
  - nginx (反向代理)
```

#### 特性
- 一键启动所有服务
- 数据持久化
- 日志管理
- 环境配置

### 10.2 诊断工具

#### 系统检查
```bash
python scripts/diagnose_system.py
```

**检查项**:
- Python版本
- 依赖包安装
- 数据库连接
- Redis连接
- API密钥配置
- 文件权限
- 网络连接

#### 输出
- 详细诊断报告
- 问题定位
- 修复建议
- 自动修复 (部分问题)

### 10.3 测试脚本

#### API连接测试
```bash
# 测试LLM提供商连接
python scripts/test_llm_connect.py --provider dashscope
python scripts/test_qianfan_connect.py
```

#### 数据同步测试
```bash
# 测试数据获取
python scripts/test_data_fetch.py --market A --symbol 000001
```

#### 完整功能测试
```bash
# 端到端测试
python examples/test_installation.py
```

### 10.4 配置向导

#### 交互式配置
```bash
python scripts/setup_wizard.py
```

**功能**:
1. 选择LLM提供商
2. 输入API密钥
3. 测试连接
4. 生成配置文件
5. 初始化数据库

#### 智能推荐
- 根据地区推荐提供商
- 根据需求推荐模型
- 成本估算

---

## 11. 实现建议

### 11.1 基于原始TradingAgents开发

#### 核心保留
- ✅ 保留 `tradingagents/` 核心库
- ✅ 保留多智能体架构
- ✅ 保留LangGraph图结构
- ✅ 保留数据流设计

#### 新增开发
- 🆕 独立开发 Web 后端 (FastAPI)
- 🆕 独立开发 Web 前端 (Vue 3)
- 🆕 实现上述所有功能模块

### 11.2 技术选型建议

#### 后端
- **Web框架**: FastAPI (推荐) 或 Flask
- **ORM**: Motor (MongoDB异步) 或 Beanie
- **认证**: PyJWT + Redis
- **任务队列**: Celery 或 ARQ
- **WebSocket**: FastAPI WebSocket

#### 前端
- **框架**: Vue 3 (推荐) 或 React
- **构建**: Vite
- **UI库**: Element Plus, Ant Design Vue, Naive UI
- **状态管理**: Pinia
- **图表**: ECharts, Chart.js

#### 数据库
- **主库**: MongoDB
- **缓存**: Redis
- **时序数据**: InfluxDB (可选，用于K线数据)

#### 部署
- **容器**: Docker + Docker Compose
- **反向代理**: Nginx
- **进程管理**: Supervisor 或 systemd

### 11.3 开发优先级

#### Phase 1: 基础设施 (1-2周)
1. FastAPI后端框架搭建
2. Vue前端框架搭建
3. 数据库设计和连接
4. 用户认证系统

#### Phase 2: 核心功能 (2-3周)
1. LLM配置管理
2. 单股分析功能 (调用原始TradingAgents)
3. 分析结果展示
4. 报告导出 (PDF/Word)

#### Phase 3: 高级功能 (3-4周)
1. 批量分析
2. 股票筛选
3. 自选股管理
4. 模拟交易

#### Phase 4: 优化完善 (2-3周)
1. 性能优化
2. 错误处理
3. 测试覆盖
4. 文档完善

### 11.4 关键注意事项

#### 法律合规
- ⚠️ **不要复制** app/ 和 frontend/ 的代码
- ✅ 参考功能需求，独立实现
- ✅ 使用自己的设计和代码
- ✅ 遵守开源许可证

#### 功能差异化
- 可以有不同的UI设计
- 可以有不同的技术实现
- 可以增加自己的创新功能
- 可以简化或扩展功能

#### 商业使用
- 如果商业化，确保完全独立实现
- 可以参考原项目的Apache 2.0部分
- 建议咨询法律顾问

---

## 12. 功能对比表

| 功能模块 | 原始TradingAgents | TradingAgents-CN | 实现建议 |
|---------|------------------|------------------|---------|
| 多智能体架构 | ✅ | ✅ | 继承使用 |
| CLI工具 | ✅ | ✅ | 继承使用 |
| Streamlit界面 | ✅ | ✅ | 继承使用 |
| FastAPI后端 | ❌ | ✅ | 独立开发 |
| Vue前端 | ❌ | ✅ | 独立开发 |
| 用户认证 | ❌ | ✅ | 独立开发 |
| LLM配置管理 | ❌ | ✅ | 独立开发 |
| 批量分析 | ❌ | ✅ | 独立开发 |
| 股票筛选 | ❌ | ✅ | 独立开发 |
| 自选股管理 | ❌ | ✅ | 独立开发 |
| 模拟交易 | ❌ | ✅ | 独立开发 |
| A股支持 | 部分 | ✅ | 增强数据源 |
| 港股支持 | ❌ | ✅ | 新增数据源 |
| 中文化 | ❌ | ✅ | 全面本地化 |
| 报告导出 | ❌ | ✅ | 独立开发 |
| Docker部署 | ❌ | ✅ | 独立开发 |

---

## 13. 总结

### 13.1 核心价值

TradingAgents-CN 在原始项目基础上的主要价值体现在:

1. **企业级Web应用**: 完整的前后端分离架构
2. **中文用户友好**: 全面的本地化和中文优化
3. **多市场支持**: A股、港股、美股数据整合
4. **生产就绪**: 用户管理、权限控制、配置中心
5. **开发者友好**: Docker部署、诊断工具、文档完善

### 13.2 技术亮点

1. **现代技术栈**: FastAPI + Vue 3 + MongoDB
2. **异步架构**: 高并发处理能力
3. **实时通信**: WebSocket实时推送
4. **智能缓存**: 多级缓存优化性能
5. **扩展性**: 易于添加新功能和新市场

### 13.3 实现路径

```
步骤1: 确认原始TradingAgents许可证 (Apache 2.0)
   ↓
步骤2: Fork或使用原始TradingAgents作为核心
   ↓
步骤3: 根据本规格说明独立开发Web层
   ↓
步骤4: 实现中文化和多市场支持
   ↓
步骤5: 集成测试和优化
   ↓
步骤6: 部署和发布
```

---

## 附录

### A. 参考资源

- **原始项目**: https://github.com/TauricResearch/TradingAgents
- **技术栈文档**:
  - FastAPI: https://fastapi.tiangolo.com/
  - Vue 3: https://vuejs.org/
  - Element Plus: https://element-plus.org/
  - MongoDB: https://www.mongodb.com/docs/

### B. 数据源参考

- **A股数据**: Tushare, AkShare
- **港股数据**: 新浪财经API, Yahoo Finance
- **美股数据**: Yahoo Finance, Alpha Vantage
- **新闻数据**: Finnhub, 东方财富

### C. LLM提供商链接

- **阿里百炼**: https://dashscope.aliyun.com/
- **DeepSeek**: https://platform.deepseek.com/
- **OpenAI**: https://platform.openai.com/
- **Google AI**: https://ai.google.dev/
- **OpenRouter**: https://openrouter.ai/

---

**文档版本**: 1.0
**最后更新**: 2025-11-17
**维护者**: Claude Code
**许可证**: 本文档仅供参考，不包含任何专有代码实现
